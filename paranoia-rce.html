<div class="sheet-main">
    <div class="sheet-header">
        <div class="sheet-header-top">
            <div class="sheet-form-title">
                <div class="sheet-form-title-image-outer-container">
                    <div class="sheet-spacer-bar"></div>
                    <div class="sheet-form-title-image-container">
                        <img class="sheet-eye-logo"
                             src="https://raw.githubusercontent.com/jonathanstokes/paranoia-character-sheet/main/image/blue-eye-logo.png"/>
                    </div>
                </div>
                <div class="sheet-form-title-outer-text-container">
                    <div class="sheet-red-bar"></div>
                    <div class="sheet-form-title-text-container">
                        <div class="sheet-title sheet-title-alpha sheet-color-dark-blue">Alpha</div>
                        <div class="sheet-title sheet-title-complex sheet-color-dark-blue">Complex</div>
                        <div class="sheet-title sheet-title-identity sheet-space-letters-to-full-width">
                            I d e n t i t y
                            <span class="sheet-space-letters-to-full-width-helper"> </span>
                        </div>
                        <div class="sheet-title sheet-title-form sheet-space-letters-to-full-width">
                            F o r m
                            <span class="sheet-space-letters-to-full-width-helper"> </span>
                        </div>
                    </div>
                </div>
            </div>
            <div class="sheet-picture">
                <img name="attr_character_avatar"/>
            </div>
        </div>
        <div class="sheet-header-bottom">
            <div class="sheet-mandatory-title sheet-space-letters-to-full-width">
                ▶ T h i s &nbsp; f o r m &nbsp; i s &nbsp; m a n d a t o r y
                <span class="sheet-space-letters-to-full-width-helper"> </span>
            </div>
        </div>
    </div>
    <div class="sheet-content">
        <div class="sheet-part">
            <div class="sheet-part-header">
                <div class="sheet-part-number"><span class="sheet-text">/// Part One</span></div>
                <div class="sheet-part-title"><span class="sheet-text">Core Information <span
                        class="sheet-chevron">›››</span></span></div>
            </div>
            <div class="sheet-part-body">
                <div class="sheet-part-body-row">
                    <div class="sheet-field-container">
                        <div class="sheet-field-title">Name:</div>
                        <input class="sheet-field sheet-field-name" type="text" name="attr_name"/>
                    </div>
                    <div class="sheet-field-container">
                        <div class="sheet-field-title">Security Clearance:</div>
                        <select class="sheet-field sheet-field-clearance" name="attr_clearance">
                            <option value="Infrared" selected="selected">Infrared</option>
                            <option value="Red">Red</option>
                            <option value="Orange">Orange</option>
                            <option value="Yellow">Yellow</option>
                            <option value="Green">Green</option>
                            <option value="Blue">Blue</option>
                            <option value="Indigo">Indigo</option>
                            <option value="Violet">Violet</option>
                            <option value="Ultraviolet">Ultraviolet</option>
                        </select>
                        <input type="hidden" name="attr_clearance_letter" value=""/>
                    </div>
                    <div class="sheet-field-container">
                        <div class="sheet-field-title">Home Sector:</div>
                        <input class="sheet-field sheet-field-sector" type="text" name="attr_sector"/>
                    </div>
                    <div class="sheet-field-container">
                        <div class="sheet-field-title">Clone#:</div>
                        <input class="sheet-field sheet-field-clone-count" type="number" name="attr_clone_count"
                               value="1"/>
                    </div>
                    <div class="sheet-field-container">
                        <div class="sheet-field-title">Gender:</div>
                        <select class="sheet-field sheet-field-gender" name="attr_gender">
                            <option value="" selected="selected"></option>
                            <option value="M">M</option>
                            <option value="F">F</option>
                        </select>
                    </div>
                    <div class="sheet-field-container">
                        <div class="sheet-field-title">Personality:</div>
                        <input class="sheet-field sheet-field-personality" type="text" name="attr_personality"/>
                    </div>
                </div>
                <div class="sheet-part-body-row">
                </div>
            </div>
        </div>
        <div class="sheet-part">
            <div class="sheet-part-header">
                <div class="sheet-part-number"><span class="sheet-text">/// Part Two</span></div>
                <div class="sheet-part-title"><span class="sheet-text">Development <span
                        class="sheet-chevron">›››</span></span></div>
            </div>
            <div class="sheet-part-body">
                <div class="sheet-part-body-row">
                    <div class="sheet-field-container">
                        <div class="sheet-field-title">Treason Stars:</div>
                        <div class="sheet-styled-radio-button-container sheet-treason-stars-container">
                            <button class="sheet-field sheet-field-treason-star" name="attr_treason_star_1"></button>
                            <button class="sheet-field sheet-field-treason-star" name="attr_treason_star_2"></button>
                            <button class="sheet-field sheet-field-treason-star" name="attr_treason_star_3"></button>
                            <button class="sheet-field sheet-field-treason-star" name="attr_treason_star_4"></button>
                            <button class="sheet-field sheet-field-treason-star" name="attr_treason_star_5"></button>
                        </div>
                    </div>
                    <div class="sheet-field-container">
                        <div class="sheet-field-title">XP Points:</div>
                        <input class="sheet-field sheet-field-xp-points" type="number" name="attr_xp_points"/>
                    </div>
                </div>
                <div class="sheet-sub-group sheet-sub-group-moxie">
                    <div class="sheet-sub-group-header sheet-stats-header">
                        Stats <span class="sheet-chevron">›››</span>
                    </div>
                </div>
                <div class="sheet-part-body-row sheet-part-body-row-stat">
                    <div class="sheet-field-container sheet-field-container-stat">
                        <div class="sheet-field-title">Violence:</div>
                        <input class="sheet-field sheet-field-stat" type="number" name="attr_violence_stat"/>
                    </div>
                    <div class="sheet-field-container sheet-field-container-stat">
                        <div class="sheet-field-title">Brains:</div>
                        <input class="sheet-field sheet-field-stat" type="number" name="attr_brains_stat"/>
                    </div>
                    <div class="sheet-field-container sheet-field-container-stat">
                        <div class="sheet-field-title">Chutzpah:</div>
                        <input class="sheet-field sheet-field-stat" type="number" name="attr_chutzpah_stat"/>
                    </div>
                    <div class="sheet-field-container sheet-field-container-stat">
                        <div class="sheet-field-title">Mechanics:</div>
                        <input class="sheet-field sheet-field-stat" type="number" name="attr_mechanics_stat"/>
                    </div>
                </div>
            </div>
        </div>
        <div class="sheet-part">
            <div class="sheet-part-header">
                <div class="sheet-part-number"><span class="sheet-text">/// Part Three</span></div>
                <div class="sheet-part-title"><span class="sheet-text">Skills <span
                        class="sheet-chevron">›››</span></span></div>
            </div>
            <div class="sheet-part-body sheet-part-body-skill">
                <div class="sheet-part-body-row">
                    <div class="sheet-part-body-column">
                        <div class="sheet-field-container sheet-field-container-skill">
                            <div class="sheet-field-title">Athletics</div>
                            <input class="sheet-field sheet-field-skill" type="number" name="attr_athletics_skill"/>
                        </div>
                        <div class="sheet-field-container sheet-field-container-skill">
                            <div class="sheet-field-title">Guns</div>
                            <input class="sheet-field sheet-field-skill" type="number" name="attr_guns_skill"/>
                        </div>
                        <div class="sheet-field-container sheet-field-container-skill">
                            <div class="sheet-field-title">Melee</div>
                            <input class="sheet-field sheet-field-skill" type="number" name="attr_melee_skill"/>
                        </div>
                        <div class="sheet-field-container sheet-field-container-skill">
                            <div class="sheet-field-title">Throw</div>
                            <input class="sheet-field sheet-field-skill" type="number" name="attr_throw_skill"/>
                        </div>
                    </div>
                    <div class="sheet-part-body-column">
                        <div class="sheet-field-container sheet-field-container-skill">
                            <div class="sheet-field-title">Science</div>
                            <input class="sheet-field sheet-field-skill" type="number" name="attr_science_skill"/>
                        </div>
                        <div class="sheet-field-container sheet-field-container-skill">
                            <div class="sheet-field-title">Psychology</div>
                            <input class="sheet-field sheet-field-skill" type="number" name="attr_psychology_skill"/>
                        </div>
                        <div class="sheet-field-container sheet-field-container-skill">
                            <div class="sheet-field-title">Bureaucracy</div>
                            <input class="sheet-field sheet-field-skill" type="number" name="attr_bureaucracy_skill"/>
                        </div>
                        <div class="sheet-field-container sheet-field-container-skill">
                            <div class="sheet-field-title">Alpha Complex</div>
                            <input class="sheet-field sheet-field-skill" type="number" name="attr_alpha_complex_skill"/>
                        </div>
                    </div>
                    <div class="sheet-part-body-column">
                        <div class="sheet-field-container sheet-field-container-skill">
                            <div class="sheet-field-title">Bluff</div>
                            <input class="sheet-field sheet-field-skill" type="number" name="attr_bluff_skill"/>
                        </div>
                        <div class="sheet-field-container sheet-field-container-skill">
                            <div class="sheet-field-title">Charm</div>
                            <input class="sheet-field sheet-field-skill" type="number" name="attr_charm_skill"/>
                        </div>
                        <div class="sheet-field-container sheet-field-container-skill">
                            <div class="sheet-field-title">Intimidate</div>
                            <input class="sheet-field sheet-field-skill" type="number" name="attr_intimidate_skill"/>
                        </div>
                        <div class="sheet-field-container sheet-field-container-skill">
                            <div class="sheet-field-title">Stealth</div>
                            <input class="sheet-field sheet-field-skill" type="number" name="attr_stealth_skill"/>
                        </div>
                    </div>
                    <div class="sheet-part-body-column">
                        <div class="sheet-field-container sheet-field-container-skill">
                            <div class="sheet-field-title">Operate</div>
                            <input class="sheet-field sheet-field-skill" type="number" name="attr_operate_skill"/>
                        </div>
                        <div class="sheet-field-container sheet-field-container-skill">
                            <div class="sheet-field-title">Engineer</div>
                            <input class="sheet-field sheet-field-skill" type="number" name="attr_engineer_skill"/>
                        </div>
                        <div class="sheet-field-container sheet-field-container-skill">
                            <div class="sheet-field-title">Program</div>
                            <input class="sheet-field sheet-field-skill" type="number" name="attr_program_skill"/>
                        </div>
                        <div class="sheet-field-container sheet-field-container-skill">
                            <div class="sheet-field-title">Demolitions</div>
                            <input class="sheet-field sheet-field-skill" type="number" name="attr_demolitions_skill"/>
                        </div>
                    </div>
                </div>
                <input class="sheet-field sheet-field-additionalSkills sheet-field-freeform-text-line" type="text"
                       name="attr_additional_skills_1"/>
                <input class="sheet-field sheet-field-additionalSkills sheet-field-freeform-text-line" type="text"
                       name="attr_additional_skills_2"/>
            </div>
        </div>
        <div class="sheet-part">
            <div class="sheet-part-header">
                <div class="sheet-part-number"><span class="sheet-text">/// Part Four</span></div>
                <div class="sheet-part-title"><span class="sheet-text">Wellbeing <span class="sheet-chevron">›››</span></span>
                </div>
            </div>
            <div class="sheet-part-body sheet-part-body-skill">
                <div class="sheet-part-body-row">
                    <div class="sheet-sub-group sheet-sub-group-moxie">
                        <div class="sheet-sub-group-header">
                            Moxie <span class="sheet-chevron">›››</span>
                        </div>
                        <div class="sheet-sub-group-body">
                            <div class="sheet-styled-radio-button-container sheet-moxie-circles-container sheet-star-cb-group">
                                <input class="sheet-field sheet-field-moxie-circles" type="radio" value="8"
                                       id="moxieCircle8" name="attr_moxie_circles"/><label for="moxieCircle8">8</label>
                                <input class="sheet-field sheet-field-moxie-circles" type="radio" value="7"
                                       id="moxieCircle7" name="attr_moxie_circles"/><label for="moxieCircle7">7</label>
                                <input class="sheet-field sheet-field-moxie-circles" type="radio" value="6"
                                       id="moxieCircle6" name="attr_moxie_circles"/><label for="moxieCircle6">6</label>
                                <input class="sheet-field sheet-field-moxie-circles" type="radio" value="5"
                                       id="moxieCircle5" name="attr_moxie_circles"/><label for="moxieCircle5">5</label>
                                <input class="sheet-field sheet-field-moxie-circles" type="radio" value="4"
                                       id="moxieCircle4" name="attr_moxie_circles"/><label for="moxieCircle4">4</label>
                                <input class="sheet-field sheet-field-moxie-circles" type="radio" value="3"
                                       id="moxieCircle3" name="attr_moxie_circles"/><label for="moxieCircle3">3</label>
                                <input class="sheet-field sheet-field-moxie-circles" type="radio" value="2"
                                       id="moxieCircle2" name="attr_moxie_circles"/><label for="moxieCircle2">2</label>
                                <input class="sheet-field sheet-field-moxie-circles" type="radio" value="1"
                                       id="moxieCircle1" name="attr_moxie_circles"/><label for="moxieCircle1">1</label>
                                <input class="sheet-field sheet-field-moxie-circles sheet-star-cb-clear" type="radio"
                                       value="0" id="moxieCircle0" name="attr_moxie_circles"/><label for="moxieCircle0">0</label>
                            </div>
                        </div>
                    </div>
                    <div class="sheet-sub-group sheet-sub-group-wounds">
                        <div class="sheet-sub-group-header">
                            Wounds <span class="sheet-chevron">›››</span>
                        </div>
                        <div class="sheet-sub-group-body">
                            <div class="sheet-field-container-wounds sheet-star-cb-group">
                                <input class="sheet-field sheet-field-wound" type="radio" value="dead"
                                       id="woundLevelDead" name="attr_wound_level"/><label
                                    for="woundLevelDead">4</label>
                                <span class="sheet-field-title">Dead</span>
                                <input class="sheet-field sheet-field-wound" type="radio" value="maimed"
                                       id="woundLevelMaimed" name="attr_wound_level"/><label
                                    for="woundLevelMaimed">3</label>
                                <span class="sheet-field-title">Maimed</span>
                                <input class="sheet-field sheet-field-wound" type="radio" value="injured"
                                       id="woundLevelInjured" name="attr_wound_level"/><label
                                    for="woundLevelInjured">2</label>
                                <span class="sheet-field-title">Injured</span>
                                <input class="sheet-field sheet-field-wound" type="radio" value="hurt"
                                       id="woundLevelHurt" name="attr_wound_level"/><label
                                    for="woundLevelHurt">1</label>
                                <span class="sheet-field-title">Hurt</span>
                                <input class="sheet-field sheet-field-wound sheet-star-cb-clear" type="radio" value="0"
                                       id="woundLevelNone" name="attr_wound_level"/><label for="moxieCircle0">0</label>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="sheet-sub-group sheet-sub-group-memory">
                    <div class="sheet-sub-group-header">
                        Memory <span class="sheet-chevron">›››</span>
                    </div>
                    <div class="sheet-sub-group-body">
                        <div class="sheet-memory-container">
                            <div class="sheet-memory-row">
                                <input class="sheet-field sheet-field-memory sheet-field-freeform-text-line" type="text"
                                       name="attr_memory_1"/>
                            </div>
                            <div class="sheet-memory-row">
                                <input class="sheet-field sheet-field-memory sheet-field-freeform-text-line" type="text"
                                       name="attr_memory_2"/>
                                <div class="sheet-zb-container">
                                    <input class="sheet-field sheet-field-memory-zb sheet-field-freeform-text-line"
                                           type="text" name="attr_memory_zb"/>
                                    <div class="sheet-field-title">ZB</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="sheet-part">
            <div class="sheet-part-header">
                <div class="sheet-part-number"><span class="sheet-text">/// Part Five</span></div>
                <div class="sheet-part-title"><span class="sheet-text">Equipment <span class="sheet-chevron">›››</span></span>
                </div>
            </div>
            <div class="sheet-part-body sheet-part-body-skill">
                <div class="sheet-sub-group sheet-sub-group-equipment">
                    <div class="sheet-sub-group-body">
                        <input class="sheet-field sheet-field-equipment sheet-field-freeform-text-line" type="text"
                               name="attr_equipment_1"/>
                        <input class="sheet-field sheet-field-equipment sheet-field-freeform-text-line" type="text"
                               name="attr_equipment_2"/>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script type="text/worker">
    console.log("Paranoia character sheet initializing.");

    const stripAttr = (nameAttribute) => {
        if (nameAttribute.indexOf('attr_') === 0) {
          return nameAttribute.substring('attr_'.length);
        }
        return nameAttribute;
    };

    // When 'clearance' changes, also change 'clearance_letter' to match
    on(`change:clearance`, () => {
        getAttrs(['clearance'], values => {
            const clearanceWord = values['clearance'];
            const clearanceLetter = clearanceWord.substring(0, 1).toUpperCase();

            setAttrs({
                [`clearance_letter`]: clearanceLetter
            });
        });
    });

    // When 'clearance' changes,
    $20('select[name="attr_clearance"]').on('change', event => {
        const attribute = stripAttr(event.htmlAttributes.name);
        getAttrs([attribute], values => {
            const clearanceWord = values[attribute];
            const cssClasses = (event.htmlAttributes.class || '').split(' ');
            // Remove any previous class (with this prefix) and add the new one.
            const colorPrefix = 'sheet-background-color-';
            const clearanceSelectEl = $20('select[name="attr_clearance"]');
            for (const cssClass of cssClasses) {
                if (cssClass.indexOf(colorPrefix) === 0) {
                    clearanceSelectEl.removeClass(cssClass);
                }
            }
            clearanceSelectEl.addClass(`${colorPrefix}${clearanceWord.toLowerCase()}`);
        });
    });

    $20('button.sheet-field-treason-star').on('click', (e) => {
        console.log("clicked:", e);
    });

    console.log("Paranoia character sheet initialized.");
</script>
